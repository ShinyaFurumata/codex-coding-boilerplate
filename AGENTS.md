<!--
codex: true
cursor: false
mcp: true
-->

ユーザーへの説明は日本語で行ってください。

# ExecPlans

複雑な機能実装や大規模なリファクタリングに取り組む際は、設計から実装完了まで `.agents/PLANS.md` に記載されている ExecPlan の手法を使用してください。作成した ExecPlan は `.agents/ExecPlans/` ディレクトリに保存し、将来の参照や再利用を可能にしてください。

# 開発スタイル / TDD 原則

機能・UI 開発タスクは原則として TDD（レッド → グリーン → リファクタ）で進めてください。実装前に失敗するテストを作成し、`pnpm test:unit` および `pnpm exec tsc --noEmit` を用いた検証結果を作業報告で共有してください。ExecPlan には、テスト観点と追加予定のケースを必ず盛り込んでください。

既存のテスト基盤に不足がある場合は、実装に進む前にテストセットアップの改善から着手してください。堅牢なテスト環境は、品質の高いコードベースの礎となります。

# ドキュメント体系

新規導入や実装を行う際は、以下のドキュメントを確認してください：

- **フレームワーク・ライブラリの追加時**：`.agents/docs/Libraries.md` を確認し、導入後は利用中のライブラリ一覧に追記
- **UI 作成時**：`.agents/docs/UICoding.md` と `.agents/docs/UIDesign.md` のルールに従って実装
- **Next.js のデバッグ時**：`.agents/docs/NextjsMCPDebug.md` を参照し、適切なデバッグ手法を選択
- **特殊なバックエンド要件**：キュー、マイクロサービス、Kafka、SQS、複雑な AI 処理などが必要な場合は `.agents/docs/VercelWorkflow.md` で実現可能性を検証

# ARCHITECTURE.md

`/ARCHITECTURE.md` は、このプロジェクトの全体像を俯瞰するための中核的なドキュメントです。

- このドキュメントには、その時点でのプロダクト実装に必要最低限のコンテキストが過不足なくまとめられているべきです
- これは生きた文書であり、各作業完了後、必要に応じて更新し、常に現実を反映した状態を保ってください
  - **環境構築段階**：詳細設計や実装の具体的な指針など、より多くの情報が役立ちます
  - **成熟したプロダクト**：全体設計やコードマップなど、より抽象的で俯瞰的な内容が役立ちます
- 詳細な実装手順や細かい注意事項は不要です。簡潔で要点を押さえた文章で記述してください

# MCP サーバー

利用するべきタイミング：

- **next-devtools**：Next.js の関する実装をコードベースから直接調査・補助する際に使用。`next dev` 実行中のアプリに接続し、ルーティングやサーバーアクションの解析を行う場合に有効
- **shadcn**：UI コンポーネントを迅速に生成する際、または shadcn/ui の設計思想に沿ったパターンを確認する際に呼び出す。生成されたコードは `.agents/UICoding.md` と `.agents/UIDesign.md` のルールに従って整形
- **ai-elements**：既存の Vercel の AI Elements に登録されているコンポーネントの情報調査、レイアウト構築やスタイル実装に関する情報取得時に利用
- **playwright**：UI を視覚的に比較・評価する場合に利用。スクリーンショット（要素単位、フルページ）を撮影し、現在の UI/UX を評価。必要に応じて PC サイズ、SP サイズでの表示確認も可能
  - Next.js 16 では `pnpm exec next dev --hostname ... --port ...` のように直接 `next dev` を呼び出してください
  - 取得した成果物は `.agents/tmp` に保存し、完了報告で保存先パスを必ず共有してください
  - 起動ログと PID を `.agents/tmp` に記録し、終了時にプロセスと Playwright ブラウザを確実に停止してください
- **chrome-devtools**：ブラウザ上で再現するバグや、パフォーマンス・ネットワーク・コンソールに関する問題を調査する際に利用
